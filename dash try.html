<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap">  
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f7f7f7;
      color: #333;
    }

    header {
      background-color:  #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      text-align: center;
      position: relative;
    }

    .user-profile {
      position: absolute;
      top: 10px;
      right: 20px;
      cursor: pointer;
    }

    .user-profile img {
      width: 30px;
      border-radius: 50%;
      margin-right: 5px;
    }

    .user-dropdown {
      display: none;
      position: absolute;
      top: 50px;
      right: 0;
      background-color:#34495e;
      color:  #ecf0f1;
      padding: 10px;
      border-radius: 5px;
    }

    .user-profile:hover .user-dropdown {
      display: block;
    }

    nav {
      background-color: #2980b9;
      color: #ecf0f1;
      padding: 10px;
      text-align: center;
    }

    main {
      display: flex;
      padding: 100px;
    }

    aside {
      width: 20%;
      background-color:#3498db;
      color: #ecf0f1;
      padding: 50px;
      border-radius: 10px;
      margin-right: 40px;
    }

    section {
      flex: 1;
      padding: 40px;
      background-color:  #ecf0f1;
      border-radius: 8px;
    }

    footer {
      background-color: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      text-align: center;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      margin-bottom: 10px;
    }

    a {
      text-decoration: none;
      color: #ecf0f1;
    }

    a:hover {
      color: #3498db;
    }

    .username {
      font-weight: bold;
      display: block;
      margin-bottom: 10px;
    }

    .profile-menu ul {
      padding: 0;
    }

    .profile-menu li {
      margin-bottom: 15px;
    }

    button {
            background-color: #3498db;
            color: #ecf0f1;
            border-radius: 25px;
            border: none;
            padding: 10px 30px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out;
        }

        button:hover {
            background-color: #2980b9;
        }
  </style>
  <!-- Add this script to your dashboard page -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
  const retrieveButton = document.getElementById("retrieveButton");

  retrieveButton.addEventListener('click', async (e) => {
    const user = auth.currentUser;

    if (user) {
      const uid = user.uid;
      const userRef = ref(getDatabase(app), `users/${uid}`);

      try {
        const userSnapshot = await get(userRef);

        if (userSnapshot.exists()) {
          const userData = userSnapshot.val();

          // Access user details
          console.log("User Details:", userData);
        } else {
          console.log("User details not found.");
        }
      } catch (error) {
        console.error("Error retrieving user details:", error.message);
      }
    } else {
      console.log("No user is currently authenticated.");
    }
  });
});

    function toggleDropdown() {
      const dropdown = document.getElementById('userDropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }
  </script>
</head>

<body>

  <header>
    <h1>Certiflix</h1>
    <div class="user-profile" onclick="toggleDropdown()">
      <img src="abstract-user-flat-4.png" alt="Profile Picture">
      <span class="username"><?php echo htmlspecialchars($userName); ?></span>
      <div class="user-dropdown" id="userDropdown">
        <ul>
          <li><a href="#">My Products</a></li>
          <li><a href="login.html">Logout</a></li>
        </ul>
      </div>
    </div>
  </header>
  
  <main>
    <aside>
      <h2>User Details:</h2>
      <ul>
        <!-- Add this element where you want to display the email -->
        <div>
          <p>Welcome, <span id="userEmail"></span>!</p>
        </div>
        <br>
        <p>If you face any difficulties contact <a href="mailto:info@yourcompany.com">info@certiflix.com</a></p>
      </ul>
    </aside>

    <section>
      <h2>About Us:</h2>
      <p>Welcome, Certiflix is a cutting-edge company specializing in the meticulous 
        verification of products showcased on various e-commerce platforms.
        With a mission to instill confidence and trust among online shoppers, we 
        employs a comprehensive and advanced verification process to ensure that the 
        products listed meet the highest standards of quality and authenticity.
        We at Certiflix aim to automatically evaluate and verifying the accuracy,
         completeness, and relevance of product images displayed on online marketplaces 
         and e-commerce platforms.</p>
      <p>To upload your product</p>
      <button type="button" id="uploadButton" class="login-btn" style="background-color: #4a5cb8; color: white; border-radius: 25px; border: none; padding: 10px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer;">
        <a href="upload product.html">Upload</a></button>
    </section>
  </main> 

  <footer>
    <p>&copy; Certiflix. All rights reserved.</p>
  </footer>

  <script>
    function toggleDropdown() {
      const dropdown = document.getElementById('userDropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }
  </script>

</body>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, orderByChild, equalTo, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAFhcQBJw7090-fJaR0K7BeVPnlRnKrYwM",
    authDomain: "authentication-7890b.firebaseapp.com",
    databaseURL: "https://authentication-7890b-default-rtdb.firebaseio.com",
    projectId: "authentication-7890b",
    storageBucket: "authentication-7890b.appspot.com",
    messagingSenderId: "527223083634",
    appId: "1:527223083634:web:4b45065de2e93a1be4e8eb"
  };


    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    const urlParams = new URLSearchParams(window.location.search);
    const userEmail = urlParams.get('email');

    const userEmailElement = document.getElementById('userEmail');
    if (userEmailElement) {
      userEmailElement.textContent = userEmail;
    }

    // Use the email value in the getUserDataByEmail function
    await getUserDataByEmail(userEmail);
</script>
</body>
</html>